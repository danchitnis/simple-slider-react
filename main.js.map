{"version":3,"file":"main.js","sources":["src/index.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\n//import \"./slider.css\";\r\n\r\ntype prop = {\r\n  width: string;\r\n  onUpdate: (value: number) => void;\r\n};\r\n\r\nexport default function Slider({ width, onUpdate }: prop) {\r\n  let [active, setActive] = useState(false);\r\n  let [value, setValue] = useState(50);\r\n  let [posPerc, setPosPerc] = useState(50);\r\n  let [handlePos, setHandlePos] = useState(0);\r\n  let [initialX, setInitialX] = useState(0);\r\n  let [sliderWidth, setSliderWidth] = useState(0);\r\n\r\n  const divMain = useRef<HTMLDivElement>(null);\r\n  const divHandle = useRef<HTMLDivElement>(null);\r\n  let pxMax = useRef<number>(0);\r\n  let pxMin = useRef<number>(0);\r\n  //let sliderWidth = useRef<number>(0);\r\n  let handleWidth = useRef<number>(0);\r\n\r\n  //let sliderWidth: number;\r\n  //let handleWidth = 0;\r\n  //let pxMin: number;\r\n  //let pxMax: number;\r\n\r\n  //const handleOffset = 10;\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      const rect = divMain.current?.getBoundingClientRect();\r\n      const divMainWidth = rect ? rect.width : 0;\r\n      const rectH = divHandle.current?.getBoundingClientRect();\r\n      handleWidth.current = rectH ? rectH.width : 0;\r\n\r\n      //const width = divMainWidth - handleWidth.current;\r\n\r\n      pxMin.current = handleWidth.current / 2;\r\n      pxMax.current = divMainWidth - pxMin.current;\r\n\r\n      setSliderWidth(divMainWidth);\r\n\r\n      console.log(\r\n        \"pxMin=\",\r\n        pxMin.current,\r\n        \" pxMax=\",\r\n        pxMax.current,\r\n        \" handlewidth=\",\r\n        handleWidth.current\r\n      );\r\n    }\r\n\r\n    handleResize();\r\n\r\n    setHandlePos((pxMax.current - pxMin.current) / 2);\r\n\r\n    window.addEventListener(\"resize\", handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  }, []);\r\n\r\n  const styleL = {\r\n    left: `${100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: `${posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n  };\r\n\r\n  const styleR = {\r\n    left: `${posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: `${100 - posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n  };\r\n\r\n  const styleHandle = {\r\n    left: `${posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: \"2em\",\r\n    zIndex: 0,\r\n  };\r\n\r\n  const styleMainDiv = {\r\n    width: width,\r\n  };\r\n\r\n  const dragStart = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    //console.log(e.currentTarget.getBoundingClientRect(), \"🍔\");\r\n    setInitialX(e.clientX - handlePos - handleWidth.current / 2);\r\n    setActive(true);\r\n    //translate(e.clientX);\r\n  };\r\n\r\n  const dragMove = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    translate(e.clientX - initialX);\r\n    onUpdate(value);\r\n  };\r\n\r\n  const newHandle = (pos: number) => {\r\n    setHandlePos(pos);\r\n    setPosPerc((100 * pos) / sliderWidth);\r\n    setValue((100 * (pos - pxMin.current)) / (pxMax.current - pxMin.current));\r\n  };\r\n\r\n  const translate = (xPos: number) => {\r\n    if (active) {\r\n      //setHandlePos(xPos - handleOffset);\r\n      const newPos = xPos - handleWidth.current / 2;\r\n\r\n      switch (true) {\r\n        case newPos < pxMin.current: {\r\n          //setHandlePos(pxMin.current);\r\n          newHandle(pxMin.current);\r\n          break;\r\n        }\r\n        case newPos > pxMax.current: {\r\n          //setHandlePos(pxMax.current);\r\n          newHandle(pxMax.current);\r\n          break;\r\n        }\r\n        default: {\r\n          //styleL = { left: `${handlePos - handleOffset}px`, width: \"2em\" };\r\n          //setValue((100 * (handlePos - handleWidth.current / 2)) / sliderWidth);\r\n          //styleR.width = `${handlePos - handleOffset}px`;\r\n          newHandle(newPos);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const dragEnd = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    setActive(false);\r\n    console.log(\"value is:\", value, \" handlePos=\", posPerc);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"simple-slider\"\r\n      style={styleMainDiv}\r\n      ref={divMain}\r\n      onMouseUp={dragEnd}\r\n      onMouseLeave={dragEnd}\r\n      onMouseMove={dragMove}>\r\n      <div\r\n        className=\"simple-slider-handle\"\r\n        ref={divHandle}\r\n        style={styleHandle}\r\n        onMouseDown={dragStart}></div>\r\n\r\n      <div className=\"simple-slider-barL\" style={styleL}></div>\r\n      <div className=\"simple-slider-barR\" style={styleR}></div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useRef","useEffect","React"],"mappings":"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"}