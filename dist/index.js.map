{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useLayoutEffect } from \"react\";\r\n\r\ntype prop = {\r\n  min: number;\r\n  max: number;\r\n  divs?: number;\r\n  inValue?: number;\r\n  onDrag: (value: number) => void;\r\n  onUpdate: (value: number) => void;\r\n  debug?: boolean;\r\n};\r\n\r\nexport default function Slider({ min, max, divs, inValue, onUpdate, onDrag, debug }: prop) {\r\n  let [active, setActive] = useState(false);\r\n  let [value, setValue] = useState(0);\r\n  let [posPerc, setPosPerc] = useState(50);\r\n  let [handlePos, setHandlePos] = useState(0);\r\n  let [initialX, setInitialX] = useState(0);\r\n  let [sliderWidth, setSliderWidth] = useState(0);\r\n\r\n  const divMain = useRef<HTMLDivElement>(null);\r\n  const divHandle = useRef<HTMLDivElement>(null);\r\n  let pxMax = useRef<number>(0);\r\n  let pxMin = useRef<number>(0);\r\n\r\n  let handleWidth = useRef<number>(0);\r\n\r\n  useLayoutEffect(() => {\r\n    function handleResize() {\r\n      const rect = divMain.current?.getBoundingClientRect();\r\n      const divMainWidth = rect ? rect.width : 0;\r\n      const rectH = divHandle.current?.getBoundingClientRect();\r\n      handleWidth.current = rectH ? rectH.width : 0;\r\n\r\n      pxMin.current = handleWidth.current / 2;\r\n      pxMax.current = divMainWidth - pxMin.current;\r\n\r\n      setSliderWidth(divMainWidth);\r\n\r\n      //const p = handleWidth.current / 2 + ((value - min) / (max - min)) * divMainWidth;\r\n      //newHandle(p);\r\n      //setValue(val);\r\n\r\n      //console.log(\"am here 😁\");\r\n    }\r\n    const midRange = (min + max) / 2;\r\n\r\n    setValue(midRange);\r\n\r\n    handleResize();\r\n\r\n    window.addEventListener(\"resize\", handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  }, [min, max]);\r\n\r\n  useLayoutEffect(() => {\r\n    const v = inValue || (min + max) / 2;\r\n    const p = handleWidth.current / 2 + ((v - min) / (max - min)) * sliderWidth;\r\n    newHandle(p);\r\n    //setHandlePos(p);\r\n    //setPosPerc((100 * p) / sliderWidth);\r\n    //setValue(v);\r\n    onDrag(v);\r\n    onUpdate(v);\r\n  }, [inValue, sliderWidth]);\r\n\r\n  const dragStart = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    setInitialX(e.clientX - handlePos - handleWidth.current / 2);\r\n    setActive(true);\r\n  };\r\n\r\n  const dragMove = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    translate(e.clientX - initialX);\r\n    onDrag(value);\r\n  };\r\n\r\n  const dragEnd = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    setActive(false);\r\n    if (debug) {\r\n      console.log(\"value is:\", value, \" handlePos=\", posPerc);\r\n    }\r\n    onUpdate(value);\r\n  };\r\n\r\n  const translate = (xPos: number) => {\r\n    if (active) {\r\n      const newPos = xPos - handleWidth.current / 2;\r\n      newHandle(checkPos(newPos));\r\n    }\r\n  };\r\n\r\n  const newHandle = (pos: number) => {\r\n    const divsd = divs || 0;\r\n    const vRelative = (pos - pxMin.current) / (pxMax.current - pxMin.current);\r\n    let val = vRelative * (max - min) + min;\r\n    let p = pos;\r\n    //\r\n    if (divsd > 1) {\r\n      const step = (max - min) / (divsd - 1);\r\n      val = Math.round(val / step) * step;\r\n      p = handleWidth.current / 2 + ((val - min) / (max - min)) * sliderWidth;\r\n    }\r\n    const pck = checkPos(p);\r\n    setHandlePos(pck);\r\n    setPosPerc((100 * pck) / sliderWidth);\r\n    setValue(val);\r\n    //console.log(posPerc);\r\n  };\r\n\r\n  const checkPos = (pos: number): number => {\r\n    switch (true) {\r\n      case pos < pxMin.current: {\r\n        return pxMin.current;\r\n        break;\r\n      }\r\n      case pos > pxMax.current: {\r\n        return pxMax.current;\r\n        break;\r\n      }\r\n      default: {\r\n        return pos;\r\n      }\r\n    }\r\n  };\r\n\r\n  const touchStart = (e: React.TouchEvent) => {\r\n    e.preventDefault();\r\n    const x = e.touches[0].clientX;\r\n    setInitialX(x - handlePos - handleWidth.current / 2);\r\n    setActive(true);\r\n  };\r\n\r\n  const touchMove = (e: React.TouchEvent) => {\r\n    e.preventDefault();\r\n    const x = e.touches[0].clientX;\r\n    translate(x - initialX);\r\n    onDrag(value);\r\n  };\r\n\r\n  const touchEnd = (e: React.TouchEvent) => {\r\n    e.preventDefault();\r\n    setActive(false);\r\n    onUpdate(value);\r\n  };\r\n\r\n  const styleL = {\r\n    left: `${100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: `${Math.abs(posPerc - 100 * (handleWidth.current / (2 * sliderWidth)))}%`,\r\n    height: \"20%\",\r\n    backgroundColor: \"lightskyblue\",\r\n    borderRadius: \"3px\",\r\n    position: \"absolute\" as \"absolute\",\r\n    zIndex: 1,\r\n    cursor: \"pointer\",\r\n  };\r\n\r\n  const styleR = {\r\n    left: `${posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: `${Math.abs(100 - posPerc - 100 * (handleWidth.current / (2 * sliderWidth)))}%`,\r\n    height: \"20%\",\r\n    backgroundColor: \"lightgray\",\r\n    borderRadius: \"3px\",\r\n    position: \"absolute\" as \"absolute\",\r\n    zIndex: 0,\r\n    cursor: \"pointer\",\r\n  };\r\n\r\n  const styleHandle = {\r\n    left: `${posPerc - 100 * (handleWidth.current / (2 * sliderWidth))}%`,\r\n    width: \"2em\",\r\n    zIndex: debug || false ? 0 : 2,\r\n    height: \"2em\",\r\n    backgroundColor: \"darkslategrey\",\r\n    border: \"0.2em solid rgba(136, 136, 136, 0.5)\",\r\n    borderRadius: \"20%\",\r\n    touchAction: \"none\",\r\n    //userSelect: \"none\",\r\n    position: \"absolute\" as \"absolute\",\r\n    //top: \"0px\",\r\n    cursor: active ? \"grabbing\" : \"grab\",\r\n  };\r\n\r\n  const styleMainDiv = {\r\n    width: \"100%\",\r\n\r\n    height: \"5em\",\r\n    backgroundColor: \"transparent\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    overflow: \"hidden\",\r\n    borderRadius: \"7px\",\r\n    touchAction: \"none\",\r\n    border: \"solid red\",\r\n    borderWidth: debug || false ? \"1px\" : \"0px\",\r\n    position: \"relative\" as \"relative\",\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={styleMainDiv}\r\n      ref={divMain}\r\n      onMouseUp={dragEnd}\r\n      onMouseLeave={dragEnd}\r\n      onMouseMove={dragMove}\r\n      onTouchMove={touchMove}\r\n      onTouchEnd={touchEnd}>\r\n      <div\r\n        ref={divHandle}\r\n        style={styleHandle}\r\n        onMouseDown={dragStart}\r\n        onTouchStart={touchStart}></div>\r\n\r\n      <div style={styleL}></div>\r\n      <div style={styleR}></div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useRef","useLayoutEffect","React"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;SAYwB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAQ;IACvF,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,GAAGA,cAAQ,CAAC,KAAK,CAAC,CAAC;IAC1C,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAGA,cAAQ,CAAC,CAAC,CAAC,CAAC;IACpC,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,GAAGA,cAAQ,CAAC,EAAE,CAAC,CAAC;IACzC,IAAI,CAAC,SAAS,EAAE,YAAY,CAAC,GAAGA,cAAQ,CAAC,CAAC,CAAC,CAAC;IAC5C,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAGA,cAAQ,CAAC,CAAC,CAAC,CAAC;IAC1C,IAAI,CAAC,WAAW,EAAE,cAAc,CAAC,GAAGA,cAAQ,CAAC,CAAC,CAAC,CAAC;IAEhD,MAAM,OAAO,GAAGC,YAAM,CAAiB,IAAI,CAAC,CAAC;IAC7C,MAAM,SAAS,GAAGA,YAAM,CAAiB,IAAI,CAAC,CAAC;IAC/C,IAAI,KAAK,GAAGA,YAAM,CAAS,CAAC,CAAC,CAAC;IAC9B,IAAI,KAAK,GAAGA,YAAM,CAAS,CAAC,CAAC,CAAC;IAE9B,IAAI,WAAW,GAAGA,YAAM,CAAS,CAAC,CAAC,CAAC;IAEpCC,qBAAe,CAAC;QACd,SAAS,YAAY;;YACnB,MAAM,IAAI,SAAG,OAAO,CAAC,OAAO,0CAAE,qBAAqB,EAAE,CAAC;YACtD,MAAM,YAAY,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;YAC3C,MAAM,KAAK,SAAG,SAAS,CAAC,OAAO,0CAAE,qBAAqB,EAAE,CAAC;YACzD,WAAW,CAAC,OAAO,GAAG,KAAK,GAAG,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;YAE9C,KAAK,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,CAAC;YACxC,KAAK,CAAC,OAAO,GAAG,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC;YAE7C,cAAc,CAAC,YAAY,CAAC,CAAC;;;;;SAO9B;QACD,MAAM,QAAQ,GAAG,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC;QAEjC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAEnB,YAAY,EAAE,CAAC;QAEf,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;QAEhD,OAAO;YACL,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;SACpD,CAAC;KACH,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IAEfA,qBAAe,CAAC;QACd,MAAM,CAAC,GAAG,OAAO,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC;QACrC,MAAM,CAAC,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,KAAK,GAAG,GAAG,GAAG,CAAC,IAAI,WAAW,CAAC;QAC5E,SAAS,CAAC,CAAC,CAAC,CAAC;;;;QAIb,MAAM,CAAC,CAAC,CAAC,CAAC;QACV,QAAQ,CAAC,CAAC,CAAC,CAAC;KACb,EAAE,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC,CAAC;IAE3B,MAAM,SAAS,GAAG,CAAC,CAAmB;QACpC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,WAAW,CAAC,CAAC,CAAC,OAAO,GAAG,SAAS,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;QAC7D,SAAS,CAAC,IAAI,CAAC,CAAC;KACjB,CAAC;IAEF,MAAM,QAAQ,GAAG,CAAC,CAAmB;QACnC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,SAAS,CAAC,CAAC,CAAC,OAAO,GAAG,QAAQ,CAAC,CAAC;QAChC,MAAM,CAAC,KAAK,CAAC,CAAC;KACf,CAAC;IAEF,MAAM,OAAO,GAAG,CAAC,CAAmB;QAClC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,SAAS,CAAC,KAAK,CAAC,CAAC;QACjB,IAAI,KAAK,EAAE;YACT,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;SACzD;QACD,QAAQ,CAAC,KAAK,CAAC,CAAC;KACjB,CAAC;IAEF,MAAM,SAAS,GAAG,CAAC,IAAY;QAC7B,IAAI,MAAM,EAAE;YACV,MAAM,MAAM,GAAG,IAAI,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,CAAC;YAC9C,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;SAC7B;KACF,CAAC;IAEF,MAAM,SAAS,GAAG,CAAC,GAAW;QAC5B,MAAM,KAAK,GAAG,IAAI,IAAI,CAAC,CAAC;QACxB,MAAM,SAAS,GAAG,CAAC,GAAG,GAAG,KAAK,CAAC,OAAO,KAAK,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC;QAC1E,IAAI,GAAG,GAAG,SAAS,IAAI,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;QACxC,IAAI,CAAC,GAAG,GAAG,CAAC;;QAEZ,IAAI,KAAK,GAAG,CAAC,EAAE;YACb,MAAM,IAAI,GAAG,CAAC,GAAG,GAAG,GAAG,KAAK,KAAK,GAAG,CAAC,CAAC,CAAC;YACvC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC;YACpC,CAAC,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,KAAK,GAAG,GAAG,GAAG,CAAC,IAAI,WAAW,CAAC;SACzE;QACD,MAAM,GAAG,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;QACxB,YAAY,CAAC,GAAG,CAAC,CAAC;QAClB,UAAU,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,WAAW,CAAC,CAAC;QACtC,QAAQ,CAAC,GAAG,CAAC,CAAC;;KAEf,CAAC;IAEF,MAAM,QAAQ,GAAG,CAAC,GAAW;QAC3B,QAAQ,IAAI;YACV,KAAK,GAAG,GAAG,KAAK,CAAC,OAAO,EAAE;gBACxB,OAAO,KAAK,CAAC,OAAO,CAAC;aAEtB;YACD,KAAK,GAAG,GAAG,KAAK,CAAC,OAAO,EAAE;gBACxB,OAAO,KAAK,CAAC,OAAO,CAAC;aAEtB;YACD,SAAS;gBACP,OAAO,GAAG,CAAC;aACZ;SACF;KACF,CAAC;IAEF,MAAM,UAAU,GAAG,CAAC,CAAmB;QACrC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,MAAM,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QAC/B,WAAW,CAAC,CAAC,GAAG,SAAS,GAAG,WAAW,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;QACrD,SAAS,CAAC,IAAI,CAAC,CAAC;KACjB,CAAC;IAEF,MAAM,SAAS,GAAG,CAAC,CAAmB;QACpC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,MAAM,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QAC/B,SAAS,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC;QACxB,MAAM,CAAC,KAAK,CAAC,CAAC;KACf,CAAC;IAEF,MAAM,QAAQ,GAAG,CAAC,CAAmB;QACnC,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,SAAS,CAAC,KAAK,CAAC,CAAC;QACjB,QAAQ,CAAC,KAAK,CAAC,CAAC;KACjB,CAAC;IAEF,MAAM,MAAM,GAAG;QACb,IAAI,EAAE,GAAG,GAAG,IAAI,WAAW,CAAC,OAAO,IAAI,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG;QAC3D,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,GAAG,IAAI,WAAW,CAAC,OAAO,IAAI,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,GAAG;QAChF,MAAM,EAAE,KAAK;QACb,eAAe,EAAE,cAAc;QAC/B,YAAY,EAAE,KAAK;QACnB,QAAQ,EAAE,UAAwB;QAClC,MAAM,EAAE,CAAC;QACT,MAAM,EAAE,SAAS;KAClB,CAAC;IAEF,MAAM,MAAM,GAAG;QACb,IAAI,EAAE,GAAG,OAAO,GAAG,GAAG,IAAI,WAAW,CAAC,OAAO,IAAI,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG;QACrE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,OAAO,GAAG,GAAG,IAAI,WAAW,CAAC,OAAO,IAAI,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,GAAG;QACtF,MAAM,EAAE,KAAK;QACb,eAAe,EAAE,WAAW;QAC5B,YAAY,EAAE,KAAK;QACnB,QAAQ,EAAE,UAAwB;QAClC,MAAM,EAAE,CAAC;QACT,MAAM,EAAE,SAAS;KAClB,CAAC;IAEF,MAAM,WAAW,GAAG;QAClB,IAAI,EAAE,GAAG,OAAO,GAAG,GAAG,IAAI,WAAW,CAAC,OAAO,IAAI,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG;QACrE,KAAK,EAAE,KAAK;QACZ,MAAM,EAAE,KAAK,IAAI,KAAK,GAAG,CAAC,GAAG,CAAC;QAC9B,MAAM,EAAE,KAAK;QACb,eAAe,EAAE,eAAe;QAChC,MAAM,EAAE,sCAAsC;QAC9C,YAAY,EAAE,KAAK;QACnB,WAAW,EAAE,MAAM;;QAEnB,QAAQ,EAAE,UAAwB;;QAElC,MAAM,EAAE,MAAM,GAAG,UAAU,GAAG,MAAM;KACrC,CAAC;IAEF,MAAM,YAAY,GAAG;QACnB,KAAK,EAAE,MAAM;QAEb,MAAM,EAAE,KAAK;QACb,eAAe,EAAE,aAAa;QAC9B,OAAO,EAAE,MAAM;QACf,UAAU,EAAE,QAAQ;QACpB,cAAc,EAAE,QAAQ;QACxB,QAAQ,EAAE,QAAQ;QAClB,YAAY,EAAE,KAAK;QACnB,WAAW,EAAE,MAAM;QACnB,MAAM,EAAE,WAAW;QACnB,WAAW,EAAE,KAAK,IAAI,KAAK,GAAG,KAAK,GAAG,KAAK;QAC3C,QAAQ,EAAE,UAAwB;KACnC,CAAC;IAEF,QACEC,sCACE,KAAK,EAAE,YAAY,EACnB,GAAG,EAAE,OAAO,EACZ,SAAS,EAAE,OAAO,EAClB,YAAY,EAAE,OAAO,EACrB,WAAW,EAAE,QAAQ,EACrB,WAAW,EAAE,SAAS,EACtB,UAAU,EAAE,QAAQ;QACpBA,sCACE,GAAG,EAAE,SAAS,EACd,KAAK,EAAE,WAAW,EAClB,WAAW,EAAE,SAAS,EACtB,YAAY,EAAE,UAAU,GAAQ;QAElCA,sCAAK,KAAK,EAAE,MAAM,GAAQ;QAC1BA,sCAAK,KAAK,EAAE,MAAM,GAAQ,CACtB,EACN;AACJ;;;;"}