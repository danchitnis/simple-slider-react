{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useState, useRef, useLayoutEffect } from \"react\";\r\n\r\ntype prop = {\r\n  min: number;\r\n  max: number;\r\n  divs?: number;\r\n  inValue?: number;\r\n  onDrag: (value: number) => void;\r\n  onUpdate: (value: number) => void;\r\n  debug?: boolean;\r\n};\r\n\r\nlet sliderWidth = 0;\r\nlet pxMax = 0;\r\nlet pxMin = 0;\r\nlet initialX = 0;\r\nlet active = false;\r\nlet dragValue = 0;\r\nlet mainValue = 0;\r\nlet handlePos = 0;\r\nlet handleWidth = 0;\r\n\r\nexport default function Slider({\r\n  min,\r\n  max,\r\n  divs,\r\n  inValue,\r\n  onUpdate,\r\n  onDrag,\r\n  debug,\r\n}: prop): JSX.Element {\r\n  const [posPerc, setPosPerc] = useState(50); //center of the handle\r\n\r\n  const divMain = useRef<HTMLDivElement>(null);\r\n  const divHandle = useRef<HTMLDivElement>(null);\r\n\r\n  useLayoutEffect(() => {\r\n    function handleResize(): void {\r\n      const rect = divMain.current?.getBoundingClientRect();\r\n      const divMainWidth = rect ? rect.width : 0;\r\n      const rectH = divHandle.current?.getBoundingClientRect();\r\n      handleWidth = rectH ? rectH.width : 0;\r\n\r\n      pxMin = handleWidth / 2;\r\n      pxMax = divMainWidth - pxMin;\r\n\r\n      sliderWidth = pxMax - pxMin;\r\n\r\n      const p = pxMin + ((mainValue - min) / (max - min)) * sliderWidth;\r\n      newHandle(p);\r\n    }\r\n\r\n    handleResize();\r\n\r\n    window.addEventListener(\"resize\", handleResize);\r\n\r\n    return (): void => {\r\n      window.removeEventListener(\"resize\", handleResize);\r\n    };\r\n  }, []);\r\n\r\n  useLayoutEffect(() => {\r\n    const v = inValue == undefined ? (min + max) / 2 : inValue;\r\n    const p = pxMin + ((v - min) / (max - min)) * sliderWidth;\r\n    newHandle(p);\r\n\r\n    //console.log(\"😁\", p);\r\n    mainValue = v;\r\n  }, [inValue]);\r\n\r\n  const dragStart = (e: React.MouseEvent): void => {\r\n    e.preventDefault();\r\n    initialX = e.clientX - handlePos - handleWidth / 2;\r\n    active = true;\r\n  };\r\n\r\n  const dragMove = (e: React.MouseEvent): void => {\r\n    e.preventDefault();\r\n    translate(e.clientX - initialX);\r\n    onDrag(dragValue);\r\n  };\r\n\r\n  const dragEnd = (e: React.MouseEvent): void => {\r\n    e.preventDefault();\r\n    active = false;\r\n    if (debug) {\r\n      //console.log(\"value is:\", v, \" handlePos=\", posPerc);\r\n    }\r\n\r\n    //console.log(handlePos);\r\n    onUpdate(dragValue);\r\n    //console.log(\"pxMax\", pxMax);\r\n  };\r\n\r\n  const translate = (xPos: number): void => {\r\n    if (active) {\r\n      const newPos = xPos - handleWidth / 2;\r\n      newHandle(checkPos(newPos));\r\n    }\r\n  };\r\n\r\n  const newHandle = (pos: number): void => {\r\n    const divsd = divs || 0;\r\n    const vRelative = (pos - pxMin) / sliderWidth;\r\n    let val = vRelative * (max - min) + min;\r\n    let p = pos;\r\n    //\r\n    if (divsd > 1) {\r\n      const step = (max - min) / (divsd - 1);\r\n      val = Math.round(val / step) * step; //????????????????\r\n      p = pxMin + ((val - min) / (max - min)) * sliderWidth;\r\n    }\r\n    const pck = checkPos(p);\r\n    handlePos = pck;\r\n    setPosPerc((100 * pck) / (handleWidth + sliderWidth));\r\n    dragValue = val;\r\n    //console.log(\"🍔\", dragValue);\r\n  };\r\n\r\n  const checkPos = (pos: number): number => {\r\n    switch (true) {\r\n      case pos < pxMin: {\r\n        return pxMin;\r\n        break;\r\n      }\r\n      case pos > pxMax: {\r\n        return pxMax;\r\n        break;\r\n      }\r\n      default: {\r\n        return pos;\r\n      }\r\n    }\r\n  };\r\n\r\n  const touchStart = (e: React.TouchEvent): void => {\r\n    e.preventDefault();\r\n    const x = e.touches[0].clientX;\r\n    initialX = x - handlePos - handleWidth / 2;\r\n    active = true;\r\n  };\r\n\r\n  const touchMove = (e: React.TouchEvent): void => {\r\n    e.preventDefault();\r\n    const x = e.touches[0].clientX;\r\n    translate(x - initialX);\r\n    onDrag(dragValue);\r\n  };\r\n\r\n  const touchEnd = (e: React.TouchEvent): void => {\r\n    e.preventDefault();\r\n    active = false;\r\n    onUpdate(mainValue);\r\n  };\r\n\r\n  const styleL = {\r\n    left: `${100 * (handleWidth / (2 * sliderWidth))}%`,\r\n    width: `${Math.abs(posPerc - 100 * (handleWidth / (2 * sliderWidth)))}%`,\r\n    height: \"20%\",\r\n    backgroundColor: \"lightskyblue\",\r\n    borderRadius: \"3px\",\r\n    position: \"absolute\" as \"absolute\",\r\n    zIndex: 1,\r\n    cursor: \"pointer\",\r\n  };\r\n\r\n  const styleR = {\r\n    left: `${posPerc}%`,\r\n    width: `${Math.abs(100 - posPerc - 100 * (handleWidth / (2 * sliderWidth)))}%`,\r\n    height: \"20%\",\r\n    backgroundColor: \"lightgray\",\r\n    borderRadius: \"3px\",\r\n    position: \"absolute\" as \"absolute\",\r\n    zIndex: 0,\r\n    cursor: \"pointer\",\r\n  };\r\n\r\n  const styleHandle = {\r\n    left: `${posPerc - 100 * (handleWidth / (2 * sliderWidth))}%`,\r\n    width: \"2em\",\r\n    zIndex: debug || false ? 0 : 2,\r\n    height: \"2em\",\r\n    backgroundColor: \"darkslategrey\",\r\n    border: \"0.2em solid rgba(136, 136, 136, 0.5)\",\r\n    borderRadius: \"20%\",\r\n    touchAction: \"none\",\r\n    //userSelect: \"none\",\r\n    position: \"absolute\" as \"absolute\",\r\n    //top: \"0px\",\r\n    cursor: active ? \"grabbing\" : \"grab\",\r\n  };\r\n\r\n  const styleMainDiv = {\r\n    width: \"100%\",\r\n\r\n    height: \"5em\",\r\n    backgroundColor: \"transparent\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    overflow: \"hidden\",\r\n    borderRadius: \"7px\",\r\n    touchAction: \"none\",\r\n    border: \"solid red\",\r\n    borderWidth: debug || false ? \"1px\" : \"0px\",\r\n    position: \"relative\" as \"relative\",\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={styleMainDiv}\r\n      ref={divMain}\r\n      onMouseUp={dragEnd}\r\n      onMouseLeave={dragEnd}\r\n      onMouseMove={dragMove}\r\n      onTouchMove={touchMove}\r\n      onTouchEnd={touchEnd}>\r\n      <div\r\n        ref={divHandle}\r\n        style={styleHandle}\r\n        onMouseDown={dragStart}\r\n        onTouchStart={touchStart}></div>\r\n\r\n      <div style={styleL}></div>\r\n      <div style={styleR}></div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useRef","useLayoutEffect","React"],"mappings":"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"}